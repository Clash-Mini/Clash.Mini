var F=Object.defineProperty,G=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var R=(e,n,s)=>n in e?F(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,p=(e,n)=>{for(var s in n||(n={}))P.call(n,s)&&R(e,s,n[s]);if(b)for(var s of b(n))O.call(n,s)&&R(e,s,n[s]);return e},x=(e,n)=>G(e,J(n));var j=(e,n)=>{var s={};for(var l in e)P.call(e,l)&&n.indexOf(l)<0&&(s[l]=e[l]);if(e!=null&&b)for(var l of b(e))n.indexOf(l)<0&&O.call(e,l)&&(s[l]=e[l]);return s};import{R as m,g as K,r as t,k as W,J as Q,j as X}from"./vendor.287bb476.js";import{r as Y}from"./logs.6f5eec90.js";import{S}from"./Select.7e745825.js";import{s as A,b as Z,d as T,e as $,u as ee,c as B,h as te,g as D,i as ne,o as ae,j as _,k as se,C as le,l as re,B as oe,n as ce,q as ie}from"./index.e91c5fc9.js";const{useState:ue,useRef:pe,useEffect:me,useCallback:de}=m;function ge(e){return m.createElement("input",p({className:A.input},e))}function fe(s){var l=s,{value:e}=l,n=j(l,["value"]);const[i,r]=ue(e),d=pe(e);me(()=>{d.current!==e&&r(e),d.current=e},[e]);const g=de(h=>r(h.target.value),[r]);return m.createElement("input",p({className:A.input,value:i,onChange:g},n))}const Ee="_root_1dybt_1",xe="_section_1dybt_11",ve="_wrapSwitch_1dybt_35",Ce="_sep_1dybt_41",be="_label_1dybt_54";var c={root:Ee,section:xe,wrapSwitch:ve,sep:Ce,label:be};const he="_fieldset_1qjic_1",ye="_input_1qjic_9",Se="_cnt_1qjic_9";var k={fieldset:he,input:ye,cnt:Se};function _e({OptionComponent:e,optionPropsList:n,selectedIndex:s,onChange:l}){const i=K("visually-hidden",k.input),r=d=>{l(d.target.value)};return m.createElement("fieldset",{className:k.fieldset},n.map((d,g)=>m.createElement("label",{key:g},m.createElement("input",{type:"radio",checked:s===g,name:"selection",value:g,"aria-labelledby":"traffic chart type "+g,onChange:r,className:i}),m.createElement("div",{className:k.cnt},m.createElement(e,p({},d))))))}const ke={legend:{display:!1},scales:{xAxes:[{display:!1}],yAxes:[{display:!1}]}},M=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],we=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],Ie=M;function Ne({id:e}){const n=Z.read(),s=t.exports.useMemo(()=>({labels:Ie,datasets:[x(p(p({},T),$[e].up),{data:M}),x(p(p({},T),$[e].down),{data:we})]}),[e]),l="chart-"+e;return ee(n,l,s,null,ke),m.createElement("div",{style:{width:100,padding:5}},m.createElement("canvas",{id:l}))}const{useEffect:U,useState:Le,useCallback:f,useRef:Pe,useMemo:Oe}=X,Re=[{id:0},{id:1},{id:2},{id:3}],je=[["debug","Debug"],["warning","Warning"],["info","Info"],["error","Error"],["silent","Silent"]],Ae=[{key:"port",label:"HTTP Proxy Port"},{key:"socks-port",label:"SOCKS5 Proxy Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"}],Te=[["en","English"],["zh_Hans","\u4E2D\u6587-\u7B80\u4F53"],["zh_Hant","\u4E2D\u6587-\u7E41\u4F53"]],$e=[["Global","Global"],["Rule","Rule"],["Direct","Direct"]],Be=e=>({configs:te(e),apiConfig:D(e)}),De=e=>({selectedChartStyleIndex:ce(e),latencyTestUrl:ie(e),apiConfig:D(e)}),Me=B(De)(qe);var Je=B(Be)(Ue);function Ue({dispatch:e,configs:n,apiConfig:s}){return U(()=>{e(ne(s))},[e,s]),t.exports.createElement(Me,{configs:n})}function qe({dispatch:e,configs:n,selectedChartStyleIndex:s,latencyTestUrl:l,apiConfig:i}){const[r,d]=Le(n),g=Pe(n);U(()=>{g.current!==n&&d(n),g.current=n},[n]);const h=f(()=>{e(ae("apiConfig"))},[e]),E=f((a,o)=>{d(x(p({},r),{[a]:o}))},[r]),q=f(a=>{const o="allow-lan",u=a;E(o,u),e(_(i,{"allow-lan":u}))},[i,e,E]),v=f(({name:a,value:o})=>{switch(a){case"mode":case"log-level":E(a,o),e(_(i,{[a]:o})),a==="log-level"&&Y(x(p({},i),{logLevel:o}));break;case"redir-port":case"socks-port":case"mixed-port":case"port":if(o!==""){const u=parseInt(o,10);if(u<0||u>65535)return}E(a,o);break;default:return}},[i,e,E]),H=f(a=>v(a.target),[v]),{selectChartStyleIndex:V,updateAppConfig:w}=se(),I=f(a=>{const o=a.target,{name:u,value:L}=o;switch(u){case"port":case"socks-port":case"mixed-port":case"redir-port":{const y=parseInt(L,10);if(y<0||y>65535)return;e(_(i,{[u]:y}));break}case"latencyTestUrl":{w(u,L);break}default:throw new Error(`unknown input name ${u}`)}},[i,e,w]),z=Oe(()=>{const a=r.mode;return typeof a=="string"&&a[0].toUpperCase()+a.slice(1)},[r.mode]),{t:C,i18n:N}=W();return t.exports.createElement("div",null,t.exports.createElement(le,{title:C("Config")}),t.exports.createElement("div",{className:c.root},Ae.map(a=>r[a.key]!==void 0?t.exports.createElement("div",{key:a.key},t.exports.createElement("div",{className:c.label},a.label),t.exports.createElement(ge,{name:a.key,value:r[a.key],onChange:H,onBlur:I})):null),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Mode"),t.exports.createElement(S,{options:$e,selected:z,onChange:a=>v({name:"mode",value:a.target.value})})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Log Level"),t.exports.createElement(S,{options:je,selected:r["log-level"],onChange:a=>v({name:"log-level",value:a.target.value})})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Allow LAN"),t.exports.createElement("div",{className:c.wrapSwitch},t.exports.createElement(re,{name:"allow-lan",checked:r["allow-lan"],onChange:q})))),t.exports.createElement("div",{className:c.sep},t.exports.createElement("div",null)),t.exports.createElement("div",{className:c.section},t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},C("latency_test_url")),t.exports.createElement(fe,{name:"latencyTestUrl",type:"text",value:l,onBlur:I})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},C("lang")),t.exports.createElement("div",null,t.exports.createElement(S,{options:Te,selected:N.language,onChange:a=>N.changeLanguage(a.target.value)}))),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},C("chart_style")),t.exports.createElement(_e,{OptionComponent:Ne,optionPropsList:Re,selectedIndex:s,onChange:V})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Action"),t.exports.createElement(oe,{start:t.exports.createElement(Q,{size:16}),label:"Switch backend",onClick:h}))))}export{Je as default};
