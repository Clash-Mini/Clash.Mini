var G=Object.defineProperty,H=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var R=(e,a,s)=>a in e?G(e,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[a]=s,p=(e,a)=>{for(var s in a||(a={}))P.call(a,s)&&R(e,s,a[s]);if(b)for(var s of b(a))O.call(a,s)&&R(e,s,a[s]);return e},x=(e,a)=>H(e,J(a));var j=(e,a)=>{var s={};for(var l in e)P.call(e,l)&&a.indexOf(l)<0&&(s[l]=e[l]);if(e!=null&&b)for(var l of b(e))a.indexOf(l)<0&&O.call(e,l)&&(s[l]=e[l]);return s};import{R as m,g as K,r as t,k as W,J as Q,j as X}from"./vendor.2c7996a3.js";import{r as Y}from"./logs.6a168654.js";import{S}from"./Select.be3bf7e5.js";import{s as A,b as Z,d as T,e as $,u as ee,c as B,h as te,g as D,i as ae,o as ne,j as k,k as se,C as le,l as re,B as oe,n as ce,q as ie}from"./index.947a4687.js";const{useState:ue,useRef:pe,useEffect:me,useCallback:de}=m;function ge(e){return m.createElement("input",p({className:A.input},e))}function Ee(s){var l=s,{value:e}=l,a=j(l,["value"]);const[i,r]=ue(e),d=pe(e);me(()=>{d.current!==e&&r(e),d.current=e},[e]);const g=de(h=>r(h.target.value),[r]);return m.createElement("input",p({className:A.input,value:i,onChange:g},a))}const fe="_root_1dybt_1",xe="_section_1dybt_11",ve="_wrapSwitch_1dybt_35",Ce="_sep_1dybt_41",be="_label_1dybt_54";var c={root:fe,section:xe,wrapSwitch:ve,sep:Ce,label:be};const he="_fieldset_1qjic_1",ye="_input_1qjic_9",Se="_cnt_1qjic_9";var _={fieldset:he,input:ye,cnt:Se};function ke({OptionComponent:e,optionPropsList:a,selectedIndex:s,onChange:l}){const i=K("visually-hidden",_.input),r=d=>{l(d.target.value)};return m.createElement("fieldset",{className:_.fieldset},a.map((d,g)=>m.createElement("label",{key:g},m.createElement("input",{type:"radio",checked:s===g,name:"selection",value:g,"aria-labelledby":"traffic chart type "+g,onChange:r,className:i}),m.createElement("div",{className:_.cnt},m.createElement(e,p({},d))))))}const _e={legend:{display:!1},scales:{xAxes:[{display:!1}],yAxes:[{display:!1}]}},M=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],we=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],Ie=M;function Ne({id:e}){const a=Z.read(),s=t.exports.useMemo(()=>({labels:Ie,datasets:[x(p(p({},T),$[e].up),{data:M}),x(p(p({},T),$[e].down),{data:we})]}),[e]),l="chart-"+e;return ee(a,l,s,null,_e),m.createElement("div",{style:{width:100,padding:5}},m.createElement("canvas",{id:l}))}const{useEffect:U,useState:Le,useCallback:E,useRef:Pe,useMemo:Oe}=X,Re=[{id:0},{id:1},{id:2},{id:3}],je=[["debug","Debug"],["warning","Warning"],["info","Info"],["error","Error"],["silent","Silent"]],Ae=[{key:"port",label:"HTTP Proxy Port"},{key:"socks-port",label:"SOCKS5 Proxy Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"}],Te=[["en","English"],["zhs","\u4E2D\u6587-\u7B80\u4F53"],["zht","\u4E2D\u6587-\u7E41\u4F53"]],$e=[["Global","Global"],["Rule","Rule"],["Direct","Direct"]],Be=e=>({configs:te(e),apiConfig:D(e)}),De=e=>({selectedChartStyleIndex:ce(e),latencyTestUrl:ie(e),apiConfig:D(e)}),Me=B(De)(qe);var Je=B(Be)(Ue);function Ue({dispatch:e,configs:a,apiConfig:s}){return U(()=>{e(ae(s))},[e,s]),t.exports.createElement(Me,{configs:a})}function qe({dispatch:e,configs:a,selectedChartStyleIndex:s,latencyTestUrl:l,apiConfig:i}){const[r,d]=Le(a),g=Pe(a);U(()=>{g.current!==a&&d(a),g.current=a},[a]);const h=E(()=>{e(ne("apiConfig"))},[e]),f=E((n,o)=>{d(x(p({},r),{[n]:o}))},[r]),q=E(n=>{const o="allow-lan",u=n;f(o,u),e(k(i,{"allow-lan":u}))},[i,e,f]),v=E(({name:n,value:o})=>{switch(n){case"mode":case"log-level":f(n,o),e(k(i,{[n]:o})),n==="log-level"&&Y(x(p({},i),{logLevel:o}));break;case"redir-port":case"socks-port":case"mixed-port":case"port":if(o!==""){const u=parseInt(o,10);if(u<0||u>65535)return}f(n,o);break;default:return}},[i,e,f]),V=E(n=>v(n.target),[v]),{selectChartStyleIndex:z,updateAppConfig:w}=se(),I=E(n=>{const o=n.target,{name:u,value:L}=o;switch(u){case"port":case"socks-port":case"mixed-port":case"redir-port":{const y=parseInt(L,10);if(y<0||y>65535)return;e(k(i,{[u]:y}));break}case"latencyTestUrl":{w(u,L);break}default:throw new Error(`unknown input name ${u}`)}},[i,e,w]),F=Oe(()=>{const n=r.mode;return typeof n=="string"&&n[0].toUpperCase()+n.slice(1)},[r.mode]),{t:C,i18n:N}=W();return t.exports.createElement("div",null,t.exports.createElement(le,{title:C("Config")}),t.exports.createElement("div",{className:c.root},Ae.map(n=>r[n.key]!==void 0?t.exports.createElement("div",{key:n.key},t.exports.createElement("div",{className:c.label},n.label),t.exports.createElement(ge,{name:n.key,value:r[n.key],onChange:V,onBlur:I})):null),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Mode"),t.exports.createElement(S,{options:$e,selected:F,onChange:n=>v({name:"mode",value:n.target.value})})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Log Level"),t.exports.createElement(S,{options:je,selected:r["log-level"],onChange:n=>v({name:"log-level",value:n.target.value})})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Allow LAN"),t.exports.createElement("div",{className:c.wrapSwitch},t.exports.createElement(re,{name:"allow-lan",checked:r["allow-lan"],onChange:q})))),t.exports.createElement("div",{className:c.sep},t.exports.createElement("div",null)),t.exports.createElement("div",{className:c.section},t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},C("latency_test_url")),t.exports.createElement(Ee,{name:"latencyTestUrl",type:"text",value:l,onBlur:I})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},C("lang")),t.exports.createElement("div",null,t.exports.createElement(S,{options:Te,selected:N.language,onChange:n=>N.changeLanguage(n.target.value)}))),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},C("chart_style")),t.exports.createElement(ke,{OptionComponent:Ne,optionPropsList:Re,selectedIndex:s,onChange:z})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Action"),t.exports.createElement(oe,{start:t.exports.createElement(Q,{size:16}),label:"Switch backend",onClick:h}))))}export{Je as default};
